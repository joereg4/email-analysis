/*
   Email Analysis YARA Rules
   Custom rules for detecting suspicious email patterns
*/

rule SuspiciousEmailPatterns {
    meta:
        description = "Detects suspicious email patterns and phishing attempts"
        author = "Email Analysis System"
        date = "2024-09-14"
    
    strings:
        $s1 = "URGENT" nocase
        $s2 = "ACT NOW" nocase
        $s3 = "CLICK HERE" nocase
        $s4 = "VERIFY YOUR ACCOUNT" nocase
        $s5 = "SUSPENDED" nocase
        $s6 = "SOCIAL SECURITY" nocase
        $s7 = "CREDIT CARD" nocase
        $s8 = "BANK ACCOUNT" nocase
        $s9 = "PASSWORD" nocase
        $s10 = "CONGRATULATIONS" nocase
        $s11 = "WINNER" nocase
        $s12 = "FREE MONEY" nocase
        $s13 = "LIMITED TIME" nocase
        $s14 = "EXPIRED" nocase
        $s15 = "IMMEDIATELY" nocase
    
    condition:
        3 of them
}

rule PhishingAttempts {
    meta:
        description = "Detects common phishing email patterns"
        author = "Email Analysis System"
        date = "2024-09-14"
    
    strings:
        $p1 = "verify your" nocase
        $p2 = "account suspended" nocase
        $p3 = "click here to" nocase
        $p4 = "personal information" nocase
        $p5 = "security question" nocase
        $p6 = "mother's maiden name" nocase
        $p7 = "date of birth" nocase
        $p8 = "student id" nocase
        $p9 = "routing number" nocase
        $p10 = "pin number" nocase
    
    condition:
        2 of them
}

rule InternationalDomains {
    meta:
        description = "Detects emails from suspicious international domains"
        author = "Email Analysis System"
        date = "2024-09-14"
    
    strings:
        $d1 = ".fj"
        $d2 = ".ru"
        $d3 = ".cn"
        $d4 = ".in"
        $d5 = ".br"
        $d6 = ".mx"
        $d7 = ".ng"
        $d8 = ".za"
        $d9 = ".tk"
        $d10 = ".ml"
    
    condition:
        1 of them
}

rule ForwardedEmails {
    meta:
        description = "Detects forwarded emails which may be suspicious"
        author = "Email Analysis System"
        date = "2024-09-14"
    
    strings:
        $f1 = "Fwd:" nocase
        $f2 = "Fw:" nocase
        $f3 = "Forwarded:" nocase
        $f4 = "Re:" nocase
    
    condition:
        1 of them
}

rule UrgencyIndicators {
    meta:
        description = "Detects excessive urgency indicators"
        author = "Email Analysis System"
        date = "2024-09-14"
    
    strings:
        $u1 = "URGENT" nocase
        $u2 = "IMMEDIATELY" nocase
        $u3 = "ASAP" nocase
        $u4 = "RIGHT NOW" nocase
        $u5 = "ACT NOW" nocase
        $u6 = "LIMITED TIME" nocase
        $u7 = "EXPIRES" nocase
        $u8 = "DEADLINE" nocase
    
    condition:
        2 of them
}

rule SuspiciousLinks {
    meta:
        description = "Detects suspicious links and URLs"
        author = "Email Analysis System"
        date = "2024-09-14"
    
    strings:
        $l1 = "http://" nocase
        $l2 = "https://" nocase
        $l3 = "bit.ly" nocase
        $l4 = "tinyurl" nocase
        $l5 = "goo.gl" nocase
        $l6 = "t.co" nocase
        $l7 = "click here" nocase
        $l8 = "verify now" nocase
    
    condition:
        2 of them
}
